@model IEnumerable<form_1a.Models.Form_1A>
@{
    ViewBag.Title = "Search Item";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-md-12 add-border" style="padding-bottom: 40px;">
            <div class="col-md-12">
                <p class="h3"><strong>Civil Registry Form No. 1A</strong></p>
                <p class="h4">(Birth Available)</p>
            </div>          
            <div class="col-md-12 form-group">
                <hr class="solid" />
            </div>
            <div class="col-sm-2">
                <label>Select Search By</label>
                <select class="form-control" id="selType">
                    <option value="lcrno" selected>LCR No.</option>
                    <option value="chname">Child's Name</option>
                    <option value="mothname">Mother's Name</option>
                    <option value="fathname">Father's Name</option>

                </select>
            </div>
            <div class="col-sm-8">
                <label>Enter Search Item</label>

                <input type="text" class="form-control" placeholder="search item" id="searchItem" />
            </div>
            <div class="col-sm-2">
                <label>&nbsp;</label>
                <input type="button" class="form-control btn btn-primary" value="Search" id="btnSearch" />
                @*<button class="form-control btn btn-primary" id="btnSearch"><i class="fa fa-search"></i><strong>Search</strong></button>*@
            </div>
            <br />
        </div>
    </div>
    <br />
    <div class="row">
        <div class="col-md-12 add-border" style="padding-top: 25px;">
            <div class="col-md-12">
                <p class="h4" style="padding-bottom: 10px;"><strong>List of Records</strong></p>
            </div>
            <div id="divResult" class="col-lg-12">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>LCR No.</th>
                            <th>Child's Name</th>
                            <th>Mother's Name</th>
                            <th>Father's Name</th>
                            <th>Date of Entry</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="bodyContents">
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td>@item.lcr_reg_no</td>
                                <td>@item.name_child</td>
                                <td>@item.name_of_mother</td>
                                <td>@item.name_of_father</td>
                                <td>@Html.DisplayFor(modelItem => item.entry)</td>
                                <td>
                                    <input class="btn btn-primary" onclick="ViewPDF('@item.filename')" id="btnViewPDF" type="button" value="View PDF" />&nbsp;
                                    <input class="btn btn-primary" type="button" value="Edit" onclick="EditItem( @item.lcr_reg_no, '@item.filename' )" />&nbsp;
                                    <input class="btn btn-primary" type="button" value="Copy" onclick="CopyRecords( @item.lcr_reg_no, '@item.filename' )" />
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>



<script src="~/Scripts/bootstrap.min.js"></script>
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript" src="http://www.datejs.com/build/date.js"></script>

<script type="text/javascript">
    $('#btnSearch').click(function () {

        var selType = $('#selType').val();          
        var searchItem = $('#searchItem').val();    
        var htmls = "";
        $('#bodyContents').html('');                

        if (searchItem != "") {
            $.ajax({
                url: '/Home/SearchThis',           
                type: 'get',
                data: { selType: selType, searchItem: searchItem }, 
                success: function (data) {
                    if (data != "0") {
                        $.each(data, function (a, b) {

                            htmls = '<tr><td>' + b.lcr_reg_no + '</td><td>' + b.name_child + '</td><td>' + b.name_of_mother + '</td><td>' + b.name_of_father + '</td><td>' + b.entry + '</td><td><input class="btn btn-primary" onclick="ViewPDF(\'' + b.filename + '\')" id="btnViewPDF" type="button" value="View PDF" />&nbsp;<input class="btn btn-primary" type="button" value="Edit"  onclick="EditItem(\'' + b.lcr_reg_no + '\',\'' + b.filename + '\')"  />&nbsp;<input class="btn btn-primary" type="button" value="Copy"  onclick="CopyRecords(\'' + b.lcr_reg_no + '\',\'' + b.filename + '\')"/></td></tr>'; 
                            $('#bodyContents').append(htmls);
                        });

                    } else {
                        alert("No Records Found");
                        location.replace("/Home/SearchItem");
                    }

                }
            })
        } else {
            alert("Field Empty!");
            location.replace("/Home/SearchItem");

        }
    });

    function ViewPDF(filename) {
        var fname = pad(filename, 5);
        window.open("/OUTPUT_PDF/FORM_1A/" + fname + ".pdf"); 
    }

    function EditItem(lcrno,filename) {
        location.replace("/Home/EditItem?lcr_no=" + lcrno + "&filename=" + filename);
    }
    function CopyRecords(lcrno, filename) {
        location.replace("/Home/CopyRecords?lcr_no=" + lcrno + "&filename=" + filename);
    }
    function Refresh() {
        location.replace("/Home/SearchItem");
    }
    function pad(str, max) {
        str = str.toString();
        return str.length < max ? pad("0" + str, max) : str;
    }
</script>
